{
    "collab_server" : "",
    "contents" : "library(fastICA)\nlibrary(pls)\n\nset.seed(12345)\ndata = read.csv(\"NIRSpectra.csv\", header = TRUE, \n                sep = \";\", dec = \",\", fill = TRUE)\n# ************************ TODO:\n# Should we remove the 'Viscosity' column when doing PCA etc??\n# ************************\n\nfeatures = princomp(data[, -ncol(data)])\nsummary(features)\n# First 3 components:\n# Proportion of Variance: 0.9463514 0.05008087 0.003372371\n# Proportion of variance in PC1 + PC2 = 0.9333233 + 0.06263367 = 0.9959569699999999 > 0.99\n# -- we choose PC1 and PC2.\n\nplot(features, main=\"PCA of different spectras\")\n\n# plot of PC1 vs PC2\nx_lim = c(min(features$scores[ ,1]), max(features$scores[ ,1]))\ny_lim = c(min(features$scores[ ,2]), max(features$scores[ ,2]))\nplot(features$scores[ ,1], features$scores[ ,2], xlim=x_lim, ylim=y_lim)\n\n# for comparison, if we look at ex. PC1 vs PC5:\n# plot(features$scores[ ,1], features$scores[ ,16], xlab=\"PC1\", ylab=\"PC2\", xlim=x_lim, ylim=y_lim)\n# .. all the variance is explained by PC1\n\nloads = loadings(features)\npar(mfrow=c(1,1))\nplot(loads[, 1], type=\"b\")\nplot(loads[, 2], type=\"b\")\n# which has 0 load? those contribute nothing to the linear transformation,\n# LOAD = how much a feature contribute to the variance within a principal component\n# i.e. how much does one dimension contribute to the variance along the dimension of the PC.\n# ************************ TODO:\n# Is there any principle component that is explained by mainly a few original features?\n# YES PC2, there are a lot of features that are around 0\n# ************************\n\nres = fastICA(data[ ,-ncol(data)], 2, fun = \"logcosh\", alpha = 1.0,\n                   row.norm = FALSE, maxit = 200, tol = 0.0001, verbose = TRUE)\n\nstr(res)\n# K = pre-whitening matrix that projects data onto the first n.comp principal components.\n# W = estimated un-mixing matrix\n# ************************ TODO:\n# What is W_prime??\n# ************************\nW_prime = res$K %*% res$W\n\nplot(W_prime[, 1])\nplot(W_prime[, 2])\n\n# ************************ TODO:\n# Make a plot of the scores of the first two latent features and compare\n# it with the score plot from step 1\n# lookup str(res) -- S ?\n# ***********************\n\nplot(res$S[, 1], res$S[, 2], main = \"Scores of first two latent features in fastICA\")\n\npcr.fit = pcr(formula = Viscosity ~ ., \n              data = data,\n              validation = \"CV\")\nvalidationplot(pcr.fit, val.type = \"MSEP\")\n# it seems after choosing more than 6 components, the MSEP doesn't go down much\nvalidationplot(pcr.fit, val.type = \"MSEP\", xlim=c(0,10))\n# TODO: Correct to say # components to select = 6??\n",
    "created" : 1511787660087.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2438079222",
    "id" : "D5C78859",
    "lastKnownWriteTime" : 1511859157,
    "last_content_update" : 1511859157227,
    "path" : "~/TDDE01/lab2/assignment4/spectra.r",
    "project_path" : "spectra.r",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}